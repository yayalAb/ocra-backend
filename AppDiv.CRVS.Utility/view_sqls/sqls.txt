1. Address_view
create view view_address as
select con.AddressNameStr as Country, reg.AddressNameStr as Region,zone.AddressNameStr as Zone,
		we.AddressNameStr as woreda,ke.AddressNameStr as Kebele,
        ifnull(ke.id,ifNull(we.id,ifNull(zone.id,ifNull(reg.id,con.id)))) as addId,
        con.id as conid,reg.id as regid,zone.id as zoneid,we.id as weId,ke.id keId
from (select * from Addresses where ParentAddressId is null) as con
left join Addresses as reg on reg.ParentAddressId = con.id
left join Addresses as zone on zone.ParentAddressId = reg.id
left join Addresses as we on we.ParentAddressId=zone.id
left join Addresses as ke on ke.ParentAddressId=we.id;

#report by Registration date
select address.woreda,ev.EventDate,gen.ValueStr as gender,ev.Status,count(ev.id) as ecount
from  Events as ev
Left join PersonalInfos as per on per.id=ev.EventowenerId
Left join Lookups as gen on gen.id=per.SexLookupId
Left join view_address as address on address.addId=ev.EventRegisteredAddressId
where eventType="Birth"
group by  address.weId, ev.Status,gen.id;


#Birth17
SELECT 
    a.*,
    l.ValueStr AS Skill,
    COUNT(n.Id) AS Total
FROM BirthNotifications as n
JOIN BirthEvents AS b ON b.Id = BirthEventId
JOIN Events as e ON e.Id = b.EventId
JOIN Lookups AS l ON l.Id = n.SkilledProfLookupId
JOIN view_address as a on a.addId = e.EventRegisteredAddressId
GROUP BY a.`addId`, n.`SkilledProfLookupId`

#Birth Site of occur 1
SELECT 
    ar.`ValueStr` AS AreaType,
    l.ValueStr AS Faculty,
    COUNT(b.Id) AS Total
FROM BirthEvents AS b
JOIN Events as e ON e.Id = b.EventId
JOIN Lookups AS l ON l.Id = b.FacilityTypeLookupId
JOIN view_address as a on a.addId = e.EventRegisteredAddressId
JOIN `Addresses` AS ad ON ad.`Id` = e.`EventRegisteredAddressId`
JOIN `Lookups` AS ar ON ar.Id = ad.`AreaTypeLookupId`
GROUP BY b.`FacilityTypeLookupId`, ad.`AreaTypeLookupId`;

# Birth Site of occur 2
SELECT 
    a.*,
    l.ValueStr AS Faculty,
    COUNT(b.Id) AS Total
FROM BirthEvents AS b
JOIN Events as e ON e.Id = b.EventId
JOIN Lookups AS l ON l.Id = b.FacilityLookupId
JOIN view_address as a on a.addId = e.EventRegisteredAddressId
GROUP BY a.`keId`, b.`FacilityLookupId`;

#Crude rate
SELECT 
	a.*,
    ar.`ValueStr` AS AreaType,
    COUNT(b.Id) AS Total
FROM BirthEvents AS b
JOIN Events as e ON e.Id = b.EventId
JOIN view_address as a on a.addId = e.EventRegisteredAddressId
JOIN `Addresses` AS ad ON ad.`Id` = a.addId
JOIN `Lookups` AS ar ON ar.Id = ad.`AreaTypeLookupId`
GROUP BY a.keId, ad.`AreaTypeLookupId`;

#Birth2
SELECT 
	a.*,
    l.`ValueStr` AS TypeOfBirth,
    COUNT(b.Id) AS Total
FROM BirthEvents AS b
JOIN Events as e ON e.Id = b.EventId
JOIN `Lookups` l ON l.`Id` = b.`TypeOfBirthLookupId`
JOIN view_address as a on a.addId = e.EventRegisteredAddressId
GROUP BY a.`addId`, b.`TypeOfBirthLookupId`;

#Birth4 1
SELECT 
    ar.`ValueStr` AS AreaType,
    l.ValueStr AS DeliveryType,
    COUNT(b.Id) AS Total
FROM `BirthNotifications` AS n
JOIN BirthEvents AS b ON b.Id = n.`BirthEventId`
JOIN Events as e ON e.Id = b.EventId
JOIN Lookups AS l ON l.Id = n.`DeliveryTypeLookupId`
JOIN view_address as a on a.addId = e.EventRegisteredAddressId
JOIN `Addresses` AS ad ON ad.`Id` = e.`EventRegisteredAddressId`
JOIN `Lookups` AS ar ON ar.Id = ad.`AreaTypeLookupId`
GROUP BY n.`DeliveryTypeLookupId`, ad.`AreaTypeLookupId`;

#birth4 2
SELECT 
    a.*,
    l.ValueStr AS DeliveryType,
    COUNT(b.Id) AS Total
FROM `BirthNotifications` AS n
JOIN BirthEvents AS b ON b.Id = n.`BirthEventId`
JOIN Events as e ON e.Id = b.EventId
JOIN Lookups AS l ON l.Id = n.`DeliveryTypeLookupId`
JOIN view_address as a on a.addId = e.EventRegisteredAddressId
GROUP BY a.`addId`, n.`DeliveryTypeLookupId`;
